# マイルストーンとタスク一覧

---

## マイルストーン 1: プロジェクトの初期セットアップ

- [x] Laravel プロジェクトの作成
- [x] Breeze パッケージのインストール
- [x] Vue と Inertia のセットアップ

---

## マイルストーン 2: シングルプレイ機能の実装

- [x] 難易度選択画面の作成 (easy, normal, hard, very hard)
- [x] シングルプレイボードの作成
- [x] ローカルストレージに状態を保存する機能の実装

---

## マイルストーン 3: マルチプレイの基礎実装

### データベース設計 & モデル実装

- [x] `rooms` テーブルのマイグレーション作成
    - カラム: `magic_token`, `max_participants`, `is_active` など
- [x] `room_participants` テーブルのマイグレーション作成
    - カラム: `room_id`, `user_id`, `joined_at`, `left_at`
- [x] `room_states` テーブルのマイグレーション作成
    - カラム: `room_id`, `board_id`, `turn_info`, `updated_at`
- [x] `boards` テーブルのマイグレーション作成
    - カラム: `width`, `height`, `mine_ratio`, `tile_state`

### リポジトリクラス作成 TDDアプローチ

- [x] マインスイーパーリポジトリ作成
- [x] ルームリポジトリ作成

### サービスクラス作成 TDD

- [] マインスイーパーサービスクラスにリポジトリクラス連結
- [] ルームサービスクラスを作成
- [] ルームサービスクラスにリポジトリクラス連結

### ルームAPI実装

- [ ] ルーム作成 API エンドポイントの実装 (`POST /multi/play/create`)
- [ ] ルーム参加 API エンドポイントの実装 (`POST /multi/play/join`)
- [ ] ルーム状態の DB 保存処理を実装
- [ ] `MultiplayerController` 内でのルームCRUD操作実装
- [ ] マジックリンク生成ロジックの実装 (`RoomService`)
- [ ] フロントエンド用のルーム作成画面の作成

---

## マイルストーン 4: ターン制ゲームルールの実装

### ゲームロジック

- [ ] ゲーム進行のルール (1 アクション制限) の実装
- [ ] ターン順序のランダム決定ロジックを実装
- [ ] プレイヤーごとのアクションの制御（最大5フラグルール）
- [ ] `MultiplayerService` 内でのターン進行管理を実装
- [ ] ゲームボードの状態更新ロジック (サーバー側)

---

## マイルストーン 5: ライブプレイ対応

### フロントエンド - リアルタイム更新

- [ ] 参加者カーソルのリアルタイム表示
- [ ] ライブ更新 (ボード状態と参加者) の実装

### ポーリング同期処理

- [ ] フロントエンド (Pinia) のポーリング処理実装
- [ ] サーバー側: 最新ルーム状態APIエンドポイント (`GET /multi/play/{magic_token}/state`) 実装

---

## マイルストーン 6: セキュリティとデプロイメント

- [ ] セッション管理とマジックリンクの実装
- [ ] パスワードのハッシュ化保存
- [ ] HTTPS 経由の通信設定
- [ ] プロジェクトのデプロイメント (Digital Ocean の環境設定)

---

## マイルストーン 7: 追加機能と最適化

### 運用対応

- [ ] ルームの自動削除機能の実装（非アクティブ状態で30日）
- [ ] ルーム削除バッチ処理の追加

### パフォーマンス最適化

- [ ] データベース索引を利用した最適化 (`magic_token`, `room_id` にインデックス追加)
- [ ] 高頻度同期のポーリング間隔の調整
- [ ] キャッシュ機能 (Redis など) の導入検討

---

## マイルストーン 8: テスト実装

### バックエンドテスト

- [ ] モデルテスト (`Room`, `RoomParticipant`, `RoomState`, `Board`)
- [ ] コントローラーテスト (APIエンドポイント)
- [ ] サービステスト (`MultiplayerService`, `RoomService`)

### フロントエンドテスト

- [ ] コンポーネント単体テスト (Vue Test Utils)
- [ ] ストア(Pinia)の単体テスト
- [ ] E2Eテスト (Cypress)

---

## マイルストーン 9: ドキュメント整備

- [ ] API仕様書の更新
- [ ] データベース設計書 (ER図やマイグレーション情報)
- [ ] 運用マニュアル (削除バッチやエラーログ監視について)

---

進捗状況に応じて各タスクをチェックしてください！
