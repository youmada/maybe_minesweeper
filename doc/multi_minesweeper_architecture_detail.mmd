flowchart TB
    subgraph "ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰"
        direction TB
        Browser["ãƒ–ãƒ©ã‚¦ã‚¶ ðŸŒ"]

        subgraph "Vue.js + Inertia.js"
            direction TB
            SinglePlayer["ã‚·ãƒ³ã‚°ãƒ«ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼\nã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ"]
            MultiPlayer["ãƒžãƒ«ãƒãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼\nã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ"]
            GameBoard["ã‚²ãƒ¼ãƒ ãƒœãƒ¼ãƒ‰\nã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ"]
            PiniaStore["Pinia ã‚¹ãƒˆã‚¢\n(ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆçŠ¶æ…‹ç®¡ç†)"]
        end

        Browser --> SinglePlayer & MultiPlayer
        SinglePlayer & MultiPlayer --> GameBoard
        SinglePlayer & MultiPlayer <--> PiniaStore
    end

    subgraph "ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰"
        direction TB

        subgraph "Controllerå±¤"
            MineController["MinesweeperController\n- ãƒªã‚¯ã‚¨ã‚¹ãƒˆå‡¦ç†\n- ãƒ¬ã‚¹ãƒãƒ³ã‚¹ç”Ÿæˆ"]
            MultiController["MultiplayerController\n- ãƒ«ãƒ¼ãƒ ç®¡ç†\n- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼å‚åŠ å‡¦ç†"]
        end

        subgraph "Serviceå±¤"
            MineService["MinesweeperService\n- ã‚²ãƒ¼ãƒ çŠ¶æ…‹ç®¡ç†\n- ã‚»ãƒƒã‚·ãƒ§ãƒ³å‡¦ç†"]
            MultiService["MultiplayerService\n- ãƒ«ãƒ¼ãƒ çŠ¶æ…‹ç®¡ç†\n- ã‚¿ãƒ¼ãƒ³å‡¦ç†"]
        end

        subgraph "Domainå±¤"
            GameService["GameService\n- ã‚³ã‚¢ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯"]
            Tile["Tile\n- ã‚¿ã‚¤ãƒ«ã®çŠ¶æ…‹ã¨æŒ¯ã‚‹èˆžã„"]
            Board["Board\n- ãƒœãƒ¼ãƒ‰ç”Ÿæˆ\n- åœ°é›·é…ç½®"]
        end

        subgraph "Repositoryå±¤"
            RoomRepo["RoomRepository\n- ãƒ«ãƒ¼ãƒ CRUDæ“ä½œ\n- å‚åŠ è€…ç®¡ç†"]
        end

        subgraph "Dataå±¤"
            DB[(ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹)]
            Cache[("ã‚­ãƒ£ãƒƒã‚·ãƒ¥\n(Redis)")]
            Session[("ã‚»ãƒƒã‚·ãƒ§ãƒ³\nã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸")]
        end

        subgraph "WebSocket"
            Echo["Laravel Echo\n(ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡)"]
        end
    end

    subgraph "ãƒ‡ãƒ—ãƒ­ã‚¤ç’°å¢ƒ (Digital Ocean)"
        direction TB
        Droplet["Droplet\n(ä»®æƒ³ã‚µãƒ¼ãƒãƒ¼)"]

        subgraph "ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆ"
            WebServer["Nginx\nWebã‚µãƒ¼ãƒãƒ¼"]
            AppServer["PHP-FPM\nã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒãƒ¼"]
            DBServer["MySQL\nãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µãƒ¼ãƒãƒ¼"]
            Redis["Redis\nã‚­ãƒ£ãƒƒã‚·ãƒ¥/WebSocket"]
            Queue["Laravel Queue\n(éžåŒæœŸå‡¦ç†)"]
        end

        Droplet --> WebServer & AppServer & DBServer & Redis & Queue
    end

%% æŽ¥ç¶šé–¢ä¿‚
    Browser <--> MineController & MultiController
    MultiPlayer <-.-> Echo

    MineController --> MineService
    MultiController --> MultiService

    MineService --> GameService
    MultiService --> GameService
    MultiService --> RoomRepo

    GameService --> Tile & Board

    RoomRepo --> DB
    MineService --> Session
    MultiService --> Cache
    Echo <--> Redis

%% ã‚¯ãƒ©ã‚¹ã‚¹ã‚¿ã‚¤ãƒ«
    classDef client fill:#dbeafe,stroke:#3b82f6,stroke-width:2px,color:#1e3a8a
    classDef controller fill:#bbf7d0,stroke:#22c55e,stroke-width:2px,color:#166534
    classDef service fill:#fef3c7,stroke:#f59e0b,stroke-width:2px,color:#92400e
    classDef domain fill:#fecaca,stroke:#ef4444,stroke-width:2px,color:#991b1b
    classDef repository fill:#e9d5ff,stroke:#a855f7,stroke-width:2px,color:#6b21a8
    classDef data fill:#e5e7eb,stroke:#6b7280,stroke-width:2px,color:#1f2937
    classDef infra fill:#fce7f3,stroke:#ec4899,stroke-width:2px,color:#831843

    class Browser,SinglePlayer,MultiPlayer,GameBoard,PiniaStore client
    class MineController,MultiController controller
    class MineService,MultiService,Echo service
    class GameService,Tile,Board domain
    class RoomRepo repository
    class DB,Cache,Session data
    class Droplet,WebServer,AppServer,DBServer,Redis,Queue infra
